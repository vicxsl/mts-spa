<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.qisen.mts.spa.dao.GoodsDao">

	<!-- 通过手机号码检测账号是否存在 -->
	<select id="check" resultType="int"
		parameterType="com.qisen.mts.spa.model.entity.SpaGoods">
		<![CDATA[
			select count(id)  from  goods 
		]]>
		<where>
			<if test="no != null and no !=''">
				<![CDATA[
					 no = #{no} 
				]]>
			</if>
			<if test="name != null and name !=''">
				<![CDATA[
					and name = #{name} 
				]]>
			</if>
			<if test="barCode != null and barCode !=''">
				<![CDATA[
					and barCode = #{barCode} 
				]]>
			</if>
			<if test="id != null and id >0">
				<![CDATA[
					and id != #{id} 
				]]>
			</if>
		</where>
	</select>
	<select id="getGoodsByPara" parameterType="com.qisen.mts.spa.model.entity.SpaGoods"
		resultType="com.qisen.mts.spa.model.entity.SpaGoods">
		select t.id,t.num,t.sid,t.eid
		from goods t where t.id=#{id} and t.eid=#{eid} and t.sid = #{sid}
	</select>

	<!--新增商品 -->
	<insert id="create" parameterType="com.qisen.mts.spa.model.entity.SpaGoods">
		<![CDATA[
			insert into goods(eid,sid,name,no,barCode,type,son_type,unit,spec,num,buyingPrice,costPrice,salePrice,goodsCompanyId,supplierId,status) 
			values(#{eid},#{sid},#{name},#{no},#{barCode},#{type},#{son_type},#{unit},#{spec},#{num},#{buyingPrice},#{costPrice},#{salePrice},#{goodsCompanyId},#{supplierId},0)
		]]>
	</insert>

	<!-- 删除账号 -->
	<delete id="delete" parameterType="com.qisen.mts.spa.model.entity.SpaGoods">
		<![CDATA[
			delete from goods
		]]>
		<where>
			<![CDATA[
				eid = #{eid} and sid = #{sid} and id=#{id}
			]]>
		</where>
	</delete>

	<update id="update" parameterType="com.qisen.mts.spa.model.entity.SpaGoods">
		<![CDATA[
			update goods
		]]>
		<set>
			<if test="name != null and name !=''">
				<![CDATA[
					 name = #{name},
				 ]]>
			</if>
			<if test="no != null and no !=''">
				<![CDATA[
					 no = #{no},
				 ]]>
			</if>
			<if test="status != null and status !=''">
				<![CDATA[
					 status = #{status},
				 ]]>
			</if>
			<if test="barCode != null and barCode !=''">
				<![CDATA[
					 barCode = #{barCode},
				 ]]>
			</if>
			<if test="type != null and type !=''">
				<![CDATA[
					 type = #{type},
				 ]]>
			</if>
			<if test="son_type != null and son_type !=''">
				<![CDATA[
					 son_type = #{son_type},
				 ]]>
			</if>
			<if test="unit != null and unit !=''">
				<![CDATA[
					 unit = #{unit},
				 ]]>
			</if>
			<if test="spec != null and spec !=''">
				<![CDATA[
					 spec = #{spec},
				 ]]>
			</if>
			<if test=" num != null and num !=''">
				<![CDATA[
					 num = #{num},
				 ]]>
			</if>
			<if test="salePrice != null and salePrice !=''">
				<![CDATA[
					 salePrice = #{salePrice},
				 ]]>
			</if>
			<if test="goodsCompanyId != null and goodsCompanyId !=''">
				<![CDATA[
					 goodsCompanyId = #{goodsCompanyId},
				 ]]>
			</if>
			<if test="supplierId != null and supplierId !=''">
				<![CDATA[
					 supplierId = #{supplierId},
				 ]]>
			</if>
		</set>
		<where>
			<![CDATA[
				 eid = #{eid} and sid = #{sid} and id = #{id}
			]]>
		</where>
	</update>



	<!-- 查询SPA商品列表 -->
	<select id="list" resultType="com.qisen.mts.spa.model.entity.SpaGoods"
		parameterType="com.qisen.mts.spa.model.entity.SpaGoods">
		<![CDATA[
			select * from goods
		]]>
		<where>
			<![CDATA[
				eid = #{eid} and sid = #{sid}
			]]>
			<if test="no != null and no !=''">
				<![CDATA[
					and no = #{no} 
				]]>
			</if>
			<if test="name != null and name !=''">
				<![CDATA[
					and name = #{name} 
				]]>
			</if>
		</where>
	</select>

</mapper>
